# 背景
如果已经有了一份电子文档截图，如何识别这份文档并且重建原来的格式？
当前ocr工具已经成为很多软件的标配，QQ、微信、mac的图片浏览器都可以进行文字识别。
但是通用的文字识别软件都只能识别文字，而不能识别文字的字体。并且在文字存在干扰的时候识别效率会下降很严重。另外也无法识别文本里面的插图，只会竭尽全能识别插图里面的文字。
而一份文章的字体和格式其实是相对固定的，重要的内容是重建格式而不是识别出来文字。
为了实现重建格式，我这里简单写了脚本。施工中。

# 已有工作
当前识别文档格式，已经有了一些工作。比如百度的paddle-oce其实是可以进行文档重建功能的。但是存在以下限制：
1. 无法识别字体、只能识别title和text两种
2. 缩进没办法识别，需要自己处理
3. 黑体、斜体、引用都没办法识别。
4. 只能区分图片(表格)和文本两种

另外，对于的字体的识别，tesertocr工具其实也是可以识别的，但是在新版本的迭代中似乎也丢失了。（stackoverflow的内容，需要进一步调研）。
在https://paperswithcode.com/task/font-recognition中，字体识别也是一种工作。

不过我们的任务是网页截图的识别，其实重要的是识别字体的字号、大小等细节。

# 实现方案
考虑到文档大部分是电子版本的，字体都已经是字库的。格式也是固定的一些排版，先使用工程的方法解决。

为了更好识别，工程的方式处理使用以下的步骤：
1. 裁边，裁出主要的文档位置
2. 删除水印，删除文字背景、行内代码的背景，减少干扰
3. 按照列投影，根据空白进行内容分割，将内容分为各个级别的标题，段落等
	1. 将分割结果安装行投影，获取缩进值、中间是否连续等信息
	2. 识别出各个块的内容类型
	3. 各个块内容的识别依据如下图
	4. 比较的重要参考是
		1. 内容的高度
		2. 内容的上下padding，必须大于某个值。

对于各种不同的格式，可能的识别条件是：
```
标题#1 高度=?px，pad>?px，左侧缩进0px，有字符间的间隔
标题#2 高度=?px，pad>?px，左侧缩进0px，有字符间的间隔
标题#3 高度=?px，pad>?px，左侧缩进0px，有字符间的间隔
标题#4 高度=?px，pad>?px，左侧缩进0px，有字符间的间隔
标题#5 高度=?px，pad>?px，左侧缩进0px，有字符间的间隔

文本 高度=?px，pad=?px，左侧缩进0px，有字符间的间隔
列表1 高度=?px，pad=?px，左侧缩进?px，有字符间的间隔
列表2 高度=?px，pad=?px，左侧缩进?px，有字符间的间隔
列表文本 高度=?px，pad=?px，左侧缩进?px，有字符间的间隔

图片 高度=?px，pad=?px，左侧缩进0px，无字符间的间隔
表格 高度=?px，pad=?px，左侧缩进0px，无字符间的间隔
公式 高度=?px，pad=?px，左侧缩进0px，无字符间的间隔
代码片段 高度=?px，pad=?px，左侧缩进0px，无字符间的间隔
引用内容 高度=?px，pad=?px，左侧缩进0px，无字符间的间隔
高亮部分 高度=?px，pad=?px，左侧缩进0px，无字符间的间隔
```

4. 对各个文字块的字进行识别
	1. 可以先试用paddle-ocr识别出字
	2. 使用PingFang字库，识别出字的类型
		1. 字体-默认PingFang
		2. 字号-默认字号
		3. 是否加粗
		4. 是否有颜色
		5. 是否有评论
		6. 是否划线
		7. 是否斜体
		8. 是否有删除线
		9. 是否有其它修饰等
5. 最后合成md文档

# 项目情况
当前simple_converter.py实现了项目的骨架，后面的实现比较琐碎，挖坑待填。
